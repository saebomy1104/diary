<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ìƒˆë´„ì´ ì¼ê¸°ë•½ğŸ“</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        /* í°íŠ¸ ì„¤ì • */
        @font-face {
            font-family: 'Paperlogy-8ExtraBold';
            src: url('https://fastly.jsdelivr.net/gh/projectnoonnu/2408-3@1.0/Paperlogy-8ExtraBold.woff2') format('woff2');
            font-weight: 800; font-style: normal;
        }
        @font-face {
            font-family: 'Paperlogy-5Medium';
            src: url('https://fastly.jsdelivr.net/gh/projectnoonnu/2408-3@1.0/Paperlogy-5Medium.woff2') format('woff2');
            font-weight: 500; font-style: normal;
        }
        @font-face {
            font-family: 'Paperlogy-6SemiBold';
            src: url('https://fastly.jsdelivr.net/gh/projectnoonnu/2408-3@1.0/Paperlogy-6SemiBold.woff2') format('woff2');
            font-weight: 600; font-style: normal;
        }

        :root {
            --bg-pink: #ffc2d4;
            --point-pink: #ff7e98;
            --soft-cream: #fffdf2;
            --text-choco: #594a4e;
            --today-bg: #ffe3e8;
            --yearly-event-bg: #fdfbf7; 
            --yearly-event-border: #eecfa1;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; user-select: none; }

        body {
            font-family: 'Paperlogy-6SemiBold', sans-serif;
            background-color: var(--bg-pink);
            background-image: 
                radial-gradient(var(--soft-cream) 3px, transparent 3.5px),
                radial-gradient(var(--soft-cream) 3px, transparent 3.5px);
            background-size: 40px 40px;
            background-position: 0 0, 20px 20px;
            color: var(--text-choco);
            height: 100vh;
            display: flex; justify-content: center; align-items: center;
            overflow: hidden;
        }

        h1, h2, h3, h4, button, input, select { font-family: 'Paperlogy-8ExtraBold', sans-serif; }

        /* íƒ€ì´í‹€ í˜ì´ì§€ */
        #title-page {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(135deg, #ffc2d4 0%, #ffe3e8 100%);
            background-image: 
                radial-gradient(var(--soft-cream) 3px, transparent 3.5px),
                radial-gradient(var(--soft-cream) 3px, transparent 3.5px);
            background-size: 40px 40px; background-position: 0 0, 20px 20px;
            z-index: 3000; display: flex; flex-direction: column;
            justify-content: center; align-items: center;
            cursor: pointer; transition: opacity 0.8s ease;
        }
        #title-page.hidden { opacity: 0; pointer-events: none; }
        .title-emojis {
            font-size: 8rem; animation: float 3s ease-in-out infinite;
            filter: drop-shadow(0 10px 10px rgba(255, 126, 152, 0.4));
        }
        @keyframes float { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-20px); } }

        /* ë©”ì¸ ì•± */
        #main-app { display: none; width: 100%; height: 100%; justify-content: center; align-items: center; opacity: 0; transition: opacity 1s; }
        #main-app.visible { display: flex; opacity: 1; }

        .calendar-container {
            background: rgba(255, 255, 255, 0.95);
            padding: 30px; border-radius: 30px;
            box-shadow: 0 20px 50px rgba(0,0,0,0.15);
            width: 95vw; height: 95vh;
            border: 5px solid white; position: relative;
            display: flex; gap: 30px;
        }

        .calendar-left { flex: 3; display: flex; flex-direction: column; position: relative; }

        .calendar-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; padding: 0 5px; }
        .header-title { font-size: 2rem; color: var(--point-pink); font-family: 'Paperlogy-8ExtraBold'; }
        
        .nav-btn-group { display: flex; gap: 5px; }
        .nav-btn { background: var(--point-pink); color: white; border: none; padding: 8px 15px; border-radius: 15px; cursor: pointer; transition: 0.2s; font-size: 0.9rem; }
        .nav-btn:hover { transform: scale(1.05); background: #ff5e7d; }
        
        /* ë‚ ì§œ ì í”„ ë©”ë‰´ */
        .date-picker-box {
            position: absolute; top: 60px; right: 10px;
            background: white; border: 2px solid var(--point-pink);
            padding: 10px; border-radius: 15px; box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            display: none; gap: 5px; z-index: 100;
        }
        .date-picker-box.show { display: flex; }
        .picker-select { padding: 5px; border: 1px solid #ddd; border-radius: 5px; color: var(--text-choco); font-family: 'Paperlogy-6SemiBold'; }

        .weekdays { display: grid; grid-template-columns: repeat(7, 1fr); text-align: center; margin-bottom: 5px; font-weight: bold; color: #888; }
        .calendar-grid { display: grid; grid-template-columns: repeat(7, 1fr); grid-auto-rows: 1fr; gap: 5px; flex-grow: 1; }
        
        .day {
            background: #fff0f5; border-radius: 8px; cursor: pointer;
            display: flex; flex-direction: column; padding: 8px;
            transition: 0.2s; position: relative; overflow: hidden;
        }
        .day:hover { background: #ffe3e8; transform: scale(0.99); }
        .day-num { font-weight: bold; font-size: 1.1rem; margin-bottom: 5px; }
        
        .day.today { background: var(--today-bg); border: 2px solid var(--point-pink); }
        .day.today .day-num { color: var(--point-pink); }
        .day.today::after { content: 'ğŸ°'; position: absolute; top: 5px; right: 5px; font-size: 1.2rem; }
        
        .day-events { display: flex; flex-direction: column; gap: 2px; overflow-y: auto; font-size: 0.8rem; flex-grow: 1; }
        .event-badge { background: white; padding: 2px 5px; border-radius: 4px; color: var(--text-choco); border-left: 3px solid var(--point-pink); font-family: 'Paperlogy-5Medium'; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .yearly-badge { background: var(--yearly-event-bg); border-left-color: var(--yearly-event-border); }
        
        .day.empty { background: transparent; cursor: default; }
        .day.empty:hover { transform: none; background: transparent; }

        /* ì—°ê°„ ìº˜ë¦°ë” */
        #yearly-page {
            display: none; position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: white; z-index: 2000; flex-direction: column; padding: 30px;
            overflow-y: auto;
        }
        #yearly-page.active { display: flex; }
        .yearly-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
        .year-nav-box { display: flex; align-items: center; gap: 15px; }
        .yearly-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 20px; padding-bottom: 30px; }
        .mini-month { border: 2px solid #eee; border-radius: 15px; padding: 10px; display: flex; flex-direction: column; }
        .mini-title { text-align: center; color: var(--point-pink); font-weight: bold; margin-bottom: 5px; }
        .mini-days { display: grid; grid-template-columns: repeat(7, 1fr); text-align: center; font-size: 0.7rem; gap: 2px; }
        .mini-day { aspect-ratio: 1/1; display: flex; align-items: center; justify-content: center; cursor: pointer; border-radius: 3px; }
        .mini-day:hover { background: var(--bg-pink); }
        .mini-day.has-event { background: var(--yearly-event-bg); color: #e67e22; font-weight: bold; border: 1px solid var(--yearly-event-border); }

        /* ğŸ“ ìš°ì¸¡ ì‚¬ì´ë“œ (íˆ¬ë‘ & ìŠ¤í‹°ì»¤) */
        .calendar-right {
            flex: 1; background: var(--soft-cream); border-radius: 20px;
            padding: 20px; border: 2px dashed var(--point-pink);
            display: flex; flex-direction: column; position: relative;
        }

        /* íˆ¬ë‘ë¦¬ìŠ¤íŠ¸ (ì œëª©/ë¬¸êµ¬ ì‚­ì œ) */
        .todo-header-row { display: flex; align-items: center; gap: 10px; margin-bottom: 10px; justify-content: center; }
        .todo-icon { font-size: 2rem; }
        
        .todo-input-group { display: flex; gap: 5px; margin-bottom: 10px; }
        .todo-input { flex: 1; padding: 10px; border: 1px solid #ddd; border-radius: 10px; outline: none; }
        .todo-btn { background: var(--point-pink); color: white; border: none; width: 40px; border-radius: 10px; cursor: pointer; }
        
        /* ğŸ‘‡ ìŠ¤í‹°ì»¤ ì¹¸ ë†’ì´ ì¡°ì •ì„ ìœ„í•´ Todo ë¦¬ìŠ¤íŠ¸ ë†’ì´ë¥¼ ëŠ˜ë¦¼ */
        .todo-list { list-style: none; overflow-y: auto; height: 60%; margin-bottom: 10px; }

        .todo-item { background: white; padding: 10px; margin-bottom: 8px; border-radius: 8px; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
        .todo-item.checked span { text-decoration: line-through; color: #bbb; }
        .check-btn { cursor: pointer; color: var(--point-pink); margin-right: 10px; }
        .del-btn { cursor: pointer; color: #aaa; font-size: 0.8rem; }

        /* ìŠ¤í‹°ì»¤ íŒ© */
        .sticker-zone {
            border-top: 2px dashed var(--point-pink);
            padding-top: 10px; 
            flex-grow: 1; 
            display: flex; flex-direction: column;
            margin-top: auto; 
        }
        .sticker-palette {
            display: flex; gap: 8px; flex-wrap: wrap; justify-content: center; align-content: flex-start;
            background: white; padding: 10px; border-radius: 15px;
            overflow-y: auto; height: 100%; 
        }
        .s-item { font-size: 1.8rem; cursor: pointer; transition: 0.2s; }
        .s-item:hover { transform: scale(1.2); }

        .draggable-sticker {
            position: absolute; font-size: 3rem; cursor: grab; z-index: 100;
            filter: drop-shadow(2px 2px 2px rgba(0,0,0,0.2));
        }
        .draggable-sticker:active { cursor: grabbing; }

        /* ì´ë™ ë²„íŠ¼ */
        .bottom-nav {
            display: flex; justify-content: flex-end; gap: 10px;
            margin-top: 10px;
        }
        .icon-btn {
            font-size: 1.5rem; background: white; border: 2px solid var(--point-pink);
            border-radius: 50%; width: 40px; height: 40px; display: flex; align-items: center; justify-content: center;
            cursor: pointer; transition: 0.2s; box-shadow: 0 3px 5px rgba(0,0,0,0.1);
        }
        .icon-btn:hover { transform: scale(1.1); background: #fff0f5; }


        /* ğŸ“– ë‹¤ì´ì–´ë¦¬ ëª¨ë‹¬ */
        .diary-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.5); backdrop-filter: blur(3px);
            display: flex; justify-content: center; align-items: center;
            z-index: 2000; opacity: 0; visibility: hidden; transition: 0.3s;
        }
        .diary-overlay.active { opacity: 1; visibility: visible; }
        .cy-window {
            width: 1100px; height: 750px; background: #eee; border-radius: 15px;
            border: 1px solid #999; box-shadow: 0 10px 30px rgba(0,0,0,0.3); padding: 15px;
            position: relative; display: flex; flex-direction: column; transform: scale(0.9); transition: 0.3s;
        }
        .diary-overlay.active .cy-window { transform: scale(1); }
        .close-btn {
            position: absolute; top: -15px; right: -15px; width: 40px; height: 40px; background: #ff7e98; border-radius: 50%;
            border: 3px solid white; color: white; font-size: 1.2rem; cursor: pointer; box-shadow: 0 3px 10px rgba(0,0,0,0.2); z-index: 20;
        }
        .cy-content { background: white; border: 1px solid #999; border-radius: 10px; flex: 1; display: flex; padding: 20px; gap: 20px; border: 2px dashed #ccc; }
        
        /* ğŸ“¸ ì™¼ìª½: ì‚¬ì§„ ìŠ¬ë¼ì´ë” ì»¨í…Œì´ë„ˆ */
        .cy-left { flex: 1; display: flex; flex-direction: column; background: #f1f1f1; border-radius: 10px; padding: 20px; align-items: center; }
        
        /* âœ¨ 1. ì‚¬ì§„ ìŠ¬ë¼ì´ë“œ ì»¨í…Œì´ë„ˆ âœ¨ */
        .photo-slider-container {
            position: relative;
            width: 100%;
            flex-grow: 1;
            overflow: hidden; 
        }
        
        /* 2. ì•¨ë²” ìì²´ (ê°€ë¡œ ìŠ¤í¬ë¡¤ ì œê±°) */
        .photo-album {
            width: 100%; 
            height: 100%; 
            display: flex; 
            gap: 10px; 
            align-items: center;
            margin-bottom: 0; 
            padding-bottom: 0; 
            transition: transform 0.3s ease-in-out; 
        }

        /* ì‚¬ì§„ í”„ë ˆì„ (ë¬´ì¡°ê±´ ì •ì‚¬ê°í˜•) */
        .photo-frame {
            min-width: 100%; 
            height: 100%; 
            background: white; border: 1px solid #ccc;
            display: flex; align-items: center; justify-content: center; overflow: hidden; position: relative;
            cursor: pointer; flex-shrink: 0; 
            box-shadow: 3px 3px 5px rgba(0,0,0,0.1);
            aspect-ratio: 1/1; /* 1:1 ë¹„ìœ¨ë¡œ ê³ ì •! */
            min-height: 150px; 
            max-height: 250px;
        }
        .photo-frame:hover { border-color: var(--point-pink); }
        .photo-frame img { 
            width: 100%; 
            height: 100%; 
            object-fit: cover; 
        }
        
        /* âœ¨ ë¯¸ë‹ˆ ì‚­ì œ ë²„íŠ¼ ìŠ¤íƒ€ì¼ âœ¨ */
        .delete-photo-mini {
            position: absolute;
            top: 5px; 
            right: 5px;
            background: var(--point-pink);
            color: white;
            border: 2px solid white;
            border-radius: 50%;
            width: 20px; /* 24px -> 20pxë¡œ ë” ì‘ê²Œ */
            height: 20px; /* 24px -> 20pxë¡œ ë” ì‘ê²Œ */
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.7rem; /* X í‘œì‹œ í¬ê¸° ì¡°ì • (ë” ì‘ê²Œ) */
            line-height: 1;
            cursor: pointer;
            z-index: 5;
            transition: transform 0.2s;
        }
        .delete-photo-mini:hover {
            transform: scale(1.1) rotate(10deg);
            background: #ff5e7d;
        }


        /* 3. ìŠ¬ë¼ì´ë“œ ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
        .slider-btn {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(255, 255, 255, 0.7);
            color: var(--point-pink);
            border: none;
            border-radius: 50%;
            width: 35px;
            height: 35px;
            font-size: 1.5rem;
            font-weight: bold;
            cursor: pointer;
            z-index: 10;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
            transition: background 0.2s;
        }

        .slider-btn:hover { background: var(--soft-cream); }
        .prev-btn { left: 10px; }
        .next-btn { right: 10px; }
        
        .add-photo-area { text-align: center; margin-top: auto; }
        .cake-upload-btn { font-size: 3.5rem; cursor: pointer; transition: 0.2s; border: none; background: none; }
        .cake-upload-btn:hover { transform: scale(1.1) rotate(10deg); }

        /* ğŸ“ ì˜¤ë¥¸ìª½: ì¼ê¸° & ìŠ¤ì¼€ì¤„ */
        .cy-right { flex: 2; display: flex; flex-direction: column; }
        .diary-header { border-bottom: 1px solid #ddd; padding-bottom: 15px; margin-bottom: 15px; }
        .diary-title-row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
        .diary-title { font-size: 1.8rem; color: var(--point-pink); font-family: 'Paperlogy-8ExtraBold'; }
        
        /* ë‚ ì”¨/ê¸°ë¶„ ì„¹ì…˜ ë””ìì¸ ìˆ˜ì • */
        .diary-options { 
            display: flex; 
            gap: 25px; 
            align-items: center; background: #f9f9f9; padding: 10px; border-radius: 10px; margin-top: 10px; 
            justify-content: flex-start; 
        }
        .option-label {
            font-family: 'Paperlogy-8ExtraBold';
            color: var(--point-pink);
            font-size: 1.1rem;
            white-space: nowrap;
        }
        .option-divider {
            color: #ddd;
            font-size: 1.8rem;
            margin: 0 5px;
        }

        .option-group { display: flex; gap: 5px; align-items: center; }
        .option-group input[type="radio"] { display: none; }
        .option-group label { cursor: pointer; font-size: 1.2rem; opacity: 0.4; transition: 0.2s; }
        .option-group label:hover { opacity: 0.7; }
        .option-group input[type="radio"]:checked + label { opacity: 1; transform: scale(1.2); }

        /* ìŠ¤ì¼€ì¤„ ì•„ì´ì½˜ ì„ íƒê¸° */
        .schedule-section { margin-bottom: 15px; padding: 10px; background: #fffdf2; border-radius: 10px; border: 1px solid #eee; }
        .schedule-title { font-size: 0.9rem; font-weight: bold; color: #888; margin-bottom: 5px; }
        .schedule-controls { display: flex; gap: 5px; align-items: center; }
        
        /* ì•„ì´ì½˜ ì„ íƒ ë“œë¡­ë‹¤ìš´ (ë„ˆë¹„ í™•ì¥) */
        #schedule-icon-select {
            font-size: 1.2rem; padding: 5px; border: 1px solid #ddd; border-radius: 5px;
            background: white; cursor: pointer; 
            width: 70px; 
            text-align: center;
        }

        .schedule-input { width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 5px; }
        .schedule-list-mini { list-style: none; font-size: 0.9rem; color: #555; padding: 0; }
        .schedule-list-mini li { display: flex; justify-content: space-between; border-bottom: 1px dashed #eee; padding: 5px 0; }

        .diary-textarea { width: 100%; flex: 1; border: none; resize: none; outline: none; font-family: 'Paperlogy-5Medium'; font-size: 1.2rem; line-height: 1.8; color: #444; background: url('data:image/svg+xml;utf8,<svg width="100%" height="30px" xmlns="http://www.w3.org/2000/svg"><line x1="0" y1="30" x2="100%" y2="30" stroke="%23eee" stroke-width="1"/></svg>'); background-size: 100% 30px; padding-top: 5px; }

        /* âœ¨ ì‚¬ì§„ ì›ë³¸ ë³´ê¸° ëª¨ë‹¬ ìŠ¤íƒ€ì¼ âœ¨ */
        #lightbox-modal {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.9);
            display: none;
            justify-content: center; align-items: center;
            z-index: 3000;
        }
        #lightbox-img {
            max-width: 90%;
            max-height: 90%;
            object-fit: contain;
            border: 5px solid white;
            border-radius: 10px;
        }
        #lightbox-delete-btn {
            position: absolute;
            bottom: 20px;
            right: 20px;
            background: #ff7e98;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1.2rem;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.3);
        }

        @media (max-width: 1024px) {
            .calendar-container { flex-direction: column; overflow-y: auto; }
            .calendar-left, .calendar-right { flex: none; height: auto; }
            .cy-window { width: 95%; height: 90vh; }
            .cy-content { flex-direction: column; overflow-y: auto; }
            .cy-left, .cy-right { width: 100%; flex: none; height: auto; }
            .photo-slider-container { height: 250px; } 
            .diary-textarea { height: 300px; }
            .diary-options { flex-wrap: wrap; }
        }
    </style>
</head>
<body>

    <div id="title-page" onclick="startApp()">
        <div class="title-emojis">ğŸ° ğŸ°</div>
    </div>

    <div id="main-app">
        <div class="calendar-container">
            <div class="calendar-left">
                <div class="calendar-header">
                    <h2 class="header-title" id="current-month-year"></h2>
                    <div class="nav-btn-group">
                        <button class="nav-btn" onclick="prevMonth()"><</button>
                        <button class="nav-btn" onclick="nextMonth()">></button>
                    </div>
                </div>
                
                <div class="date-picker-box" id="date-picker">
                    <select id="year-select" class="picker-select"></select>
                    <select id="month-select" class="picker-select"></select>
                    <button class="nav-btn" onclick="jumpToDate()">Go!</button>
                </div>

                <div class="weekdays"><div>Sun</div><div>Mon</div><div>Tue</div><div>Wed</div><div>Thu</div><div>Fri</div><div>Sat</div></div>
                <div class="calendar-grid" id="calendar-grid"></div>
            </div>

            <div class="calendar-right">
                <div class="todo-header-row">
                    <span class="todo-icon">ğŸ°</span>
                    </div>
                <div class="todo-input-group">
                    <input type="text" id="todo-input" class="todo-input">
                    <button class="todo-btn" onclick="addTodo()"><i class="fas fa-plus"></i></button>
                </div>
                <ul class="todo-list" id="todo-list"></ul>

                <div class="sticker-zone">
                    <div class="sticker-palette">
                        <div class="s-item" onclick="spawnSticker('ğŸ€')">ğŸ€</div>
                        <div class="s-item" onclick="spawnSticker('ğŸ°')">ğŸ°</div>
                        <div class="s-item" onclick="spawnSticker('ğŸ‡')">ğŸ‡</div>
                        <div class="s-item" onclick="spawnSticker('ğŸ¥')">ğŸ¥</div>
                        <div class="s-item" onclick="spawnSticker('ğŸ¤')">ğŸ¤</div>
                        <div class="s-item" onclick="spawnSticker('ğŸ£')">ğŸ£</div>
                        <div class="s-item" onclick="spawnSticker('âœ¨')">âœ¨</div>
                        <div class="s-item" onclick="spawnSticker('ğŸ')">ğŸ</div>
                        <div class="s-item" onclick="spawnSticker('ğŸ›’')">ğŸ›’</div>
                        <div class="s-item" onclick="spawnSticker('ğŸ¨')">ğŸ¨</div>
                        <div class="s-item" onclick="spawnSticker('ğŸ’¸')">ğŸ’¸</div>
                        <div class="s-item" onclick="spawnSticker('ğŸ§')">ğŸ§</div>
                        <div class="s-item" onclick="spawnSticker('ğŸ¦')">ğŸ¦</div>
                        <div class="s-item" onclick="spawnSticker('ğŸ°')">ğŸ°</div>
                        <div class="s-item" onclick="spawnSticker('ğŸ¬')">ğŸ¬</div>
                        <div class="s-item" onclick="spawnSticker('ğŸ­')">ğŸ­</div>
                        <div class="s-item" onclick="spawnSticker('ğŸ§')">ğŸ§</div>
                        <div class="s-item" onclick="spawnSticker('ğŸ‘')">ğŸ‘</div>
                        <div class="s-item" onclick="spawnSticker('ğŸ¥•')">ğŸ¥•</div>
                        <div class="s-item" onclick="spawnSticker('ğŸŒ¸')">ğŸŒ¸</div>
                        <div class="s-item" onclick="spawnSticker('ğŸ“')">ğŸ“</div>
                        <div class="s-item" onclick="spawnSticker('ğŸŒ¼')">ğŸŒ¼</div>
                        <div class="s-item" onclick="spawnSticker('ğŸŒ·')">ğŸŒ·</div>
                        <div class="s-item" onclick="spawnSticker('â­')">â­</div>
                        <div class="s-item" onclick="spawnSticker('ğŸ’•')">ğŸ’•</div>
                        <div class="s-item" onclick="spawnSticker('ğŸ’—')">ğŸ’—</div>
                        <div class="s-item" onclick="spawnSticker('ğŸ’“')">ğŸ’“</div>
                        <div class="s-item" onclick="spawnSticker('ğŸ’')">ğŸ’</div>
                        <div class="s-item" onclick="spawnSticker('ğŸ’–')">ğŸ’–</div>
                        <div class="s-item" onclick="spawnSticker('ğŸ’')">ğŸ’</div>
                        <div class="s-item" onclick="spawnSticker('ğŸ’˜')">ğŸ’˜</div>
                        <div class="s-item" onclick="spawnSticker('ğŸ’”')">ğŸ’”</div>
                        <div class="s-item" onclick="spawnSticker('ğŸ’Œ')">ğŸ’Œ</div>
                    </div>

                    <div class="bottom-nav">
                        <button class="icon-btn" onclick="goToToday()" title="Today">ğŸ </button>
                        <button class="icon-btn" onclick="togglePicker()" title="Jump">ğŸ°</button>
                        <button class="icon-btn" onclick="showYearly()" title="Yearly">ğŸ¥•</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="yearly-page">
        <div class="yearly-header">
            <div class="year-nav-box">
                <button class="nav-btn" onclick="prevYear()"><</button>
                <h2 class="header-title" id="yearly-title"></h2>
                <button class="nav-btn" onclick="nextYear()">></button>
            </div>
            <button class="nav-btn" onclick="closeYearly()">Close X</button>
        </div>
        <div class="yearly-grid" id="yearly-grid"></div>
    </div>

    <div class="diary-overlay" id="diary-modal">
        <div class="cy-window">
            <button class="close-btn" onclick="closeDiary()"><i class="fas fa-times"></i></button>
            
            <div class="cy-content">
                <div class="cy-left">
                    <div class="photo-slider-container">
                        <button class="slider-btn prev-btn" onclick="slidePhoto(-1)">&lt;</button>
                        
                        <div class="photo-album" id="photo-album"></div>
                        
                        <button class="slider-btn next-btn" onclick="slidePhoto(1)">&gt;</button>
                    </div>

                    <div class="add-photo-area">
                        <label for="photo-input" class="cake-upload-btn" id="cake-btn">ğŸ°</label>
                    </div>
                    <input type="file" id="photo-input" accept="image/*" style="display:none;" onchange="uploadPhoto(event)">
                </div>

                <div class="cy-right">
                    <div class="diary-header">
                        <span class="diary-title" id="modal-date"></span>
                        <div class="diary-options">
                            <span class="option-label">Weather:</span>
                            <div class="option-group">
                                <input type="radio" name="weather" id="w1" value="w1"><label for="w1">â˜€ï¸</label>
                                <input type="radio" name="weather" id="w2" value="w2"><label for="w2">â˜ï¸</label>
                                <input type="radio" name="weather" id="w3" value="w3"><label for="w3">â˜”</label>
                                <input type="radio" name="weather" id="w4" value="w4"><label for="w4">â„ï¸</label>
                            </div>
                            
                            <span class="option-divider">|</span>
                            
                            <span class="option-label">Mood:</span>
                            <div class="option-group">
                                <input type="radio" name="mood" id="m1" value="m1"><label for="m1">ğŸ¥°</label>
                                <input type="radio" name="mood" id="m2" value="m2"><label for="m2">ğŸ™‚</label>
                                <input type="radio" name="mood" id="m3" value="m3"><label for="m3">ğŸ˜</label>
                                <input type="radio" name="mood" id="m4" value="m4"><label for="m4">ğŸ˜­</label>
                                <input type="radio" name="mood" id="m5" value="m5"><label for="m5">ğŸ˜¡</label>
                            </div>
                        </div>
                    </div>

                    <div class="schedule-section">
                        <div class="schedule-title">â° Today's Schedule</div>
                        <div class="schedule-controls">
                            <select id="schedule-icon-select">
                                <option value="ğŸ€">ğŸ€</option>
                                <option value="ğŸ°">ğŸ°</option>
                                <option value="âœ¨">âœ¨</option>
                                <option value="ğŸ°">ğŸ°</option>
                                <option value="ğŸ">ğŸ</option>
                                <option value="ğŸ“">ğŸ“</option>
                                <option value="â­">â­</option>
                            </select>
                            <input type="text" id="daily-schedule-input" class="schedule-input" placeholder="ì¼ì • ì…ë ¥">
                            <button class="nav-btn" style="padding:5px 10px;" onclick="addDailySchedule()">Add</button>
                        </div>
                        <ul id="daily-schedule-list" class="schedule-list-mini"></ul>
                    </div>

                    <textarea class="diary-textarea" id="diary-text" placeholder=""></textarea>
                </div>
            </div>
        </div>
    </div>
    
    <div id="lightbox-modal" onclick="hideLightbox()">
        <img id="lightbox-img" src="" alt="í™•ëŒ€ ì‚¬ì§„">
        <button id="lightbox-delete-btn" onclick="event.stopPropagation(); deleteLightboxPhoto();">ğŸ—‘ï¸ ì‚­ì œ</button>
    </div>

    <script>
        // --- ë°ì´í„° ---
        let diaryDB = JSON.parse(localStorage.getItem('sb_diary')) || {};
        let yearlyDB = JSON.parse(localStorage.getItem('sb_yearly')) || {};
        let todos = JSON.parse(localStorage.getItem('sb_todos')) || {}; 
        let stickers = JSON.parse(localStorage.getItem('sb_stickers')) || []; 

        let currentDate = new Date();
        let yearlyYear = new Date().getFullYear();
        let currentKey = null;
        let currentPhotoIndex = 0; 
        let currentLightboxIndex = -1; 

        function startApp() {
            document.getElementById('title-page').classList.add('hidden');
            setTimeout(() => {
                document.getElementById('title-page').style.display = 'none';
                document.getElementById('main-app').classList.add('visible');
            }, 800);
        }

        // --- ìº˜ë¦°ë” ë Œë”ë§ ---
        function renderCalendar() {
            const grid = document.getElementById('calendar-grid');
            grid.innerHTML = '';
            const year = currentDate.getFullYear();
            const month = currentDate.getMonth();
            const today = new Date();

            const monthNames = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"];
            document.getElementById('current-month-year').innerText = `${monthNames[month]} ${year}`;

            const firstDay = new Date(year, month, 1).getDay();
            const lastDate = new Date(year, month + 1, 0).getDate();

            for(let i=0; i<firstDay; i++) {
                grid.innerHTML += `<div class="day empty"></div>`;
            }

            for(let i=1; i<=lastDate; i++) {
                const dayEl = document.createElement('div');
                dayEl.className = 'day';
                
                if(year === today.getFullYear() && month === today.getMonth() && i === today.getDate()) {
                    dayEl.classList.add('today');
                }

                const dateKey = `${year}-${month}-${i}`;
                const yearlyKey = `${month}-${i}`;

                let html = `<div class="day-num">${i}</div><div class="day-events">`;

                // ì—°ê°„ ì¼ì •
                if (yearlyDB[yearlyKey]) {
                    html += `<div class="event-badge yearly-badge">ğŸ° ${yearlyDB[yearlyKey]}</div>`;
                }
                // ìŠ¤ì¼€ì¤„ ì•„ì´ì½˜ í‘œì‹œ 
                if (diaryDB[dateKey] && diaryDB[dateKey].schedules) {
                    diaryDB[dateKey].schedules.forEach(sch => {
                        html += `<div class="event-badge">${sch.icon} ${sch.text}</div>`;
                    });
                }
                if (diaryDB[dateKey] && diaryDB[dateKey].text) {
                    html += `<div style="margin-top:auto; text-align:right;">ğŸ“</div>`;
                }
                html += `</div>`;
                dayEl.innerHTML = html;
                dayEl.onclick = () => openDiary(year, month, i);
                grid.appendChild(dayEl);
            }
            renderTodos();
            loadStickersToView();
        }

        function prevMonth() { currentDate.setMonth(currentDate.getMonth() - 1); renderCalendar(); }
        function nextMonth() { currentDate.setMonth(currentDate.getMonth() + 1); renderCalendar(); }

        // --- íˆ¬ë‘ë¦¬ìŠ¤íŠ¸ ---
        function renderTodos() {
            const list = document.getElementById('todo-list');
            list.innerHTML = '';
            const k = `${currentDate.getFullYear()}-${currentDate.getMonth()}`;
            const items = todos[k] || [];
            items.forEach((t, i) => {
                list.innerHTML += `<li class="todo-item ${t.done ? 'checked' : ''}"><span onclick="toggleTodo('${k}',${i})">${t.text}</span> <i class="fas fa-trash-alt del-btn" onclick="delTodo('${k}',${i})"></i></li>`;
            });
        }
        function addTodo() {
            const v = document.getElementById('todo-input').value;
            if(!v) return;
            const k = `${currentDate.getFullYear()}-${currentDate.getMonth()}`;
            if(!todos[k]) todos[k] = [];
            todos[k].push({ text: v, done: false });
            localStorage.setItem('sb_todos', JSON.stringify(todos));
            document.getElementById('todo-input').value = '';
            renderTodos();
        }
        function toggleTodo(k, i) { todos[k][i].done = !todos[k][i].done; localStorage.setItem('sb_todos', JSON.stringify(todos)); renderTodos(); }
        function delTodo(k, i) { todos[k].splice(i, 1); localStorage.setItem('sb_todos', JSON.stringify(todos)); renderTodos(); }

        // --- ì—°ê°„ ìº˜ë¦°ë” ---
        function showYearly() {
            yearlyYear = currentDate.getFullYear();
            document.getElementById('yearly-page').classList.add('active');
            renderYearlyView();
        }
        function closeYearly() {
            document.getElementById('yearly-page').classList.remove('active');
            renderCalendar();
        }
        function prevYear() { yearlyYear--; renderYearlyView(); }
        function nextYear() { yearlyYear++; renderYearlyView(); }

        function renderYearlyView() {
            const grid = document.getElementById('yearly-grid');
            grid.innerHTML = '';
            document.getElementById('yearly-title').innerText = yearlyYear;

            for(let m=0; m<12; m++) {
                const mini = document.createElement('div');
                mini.className = 'mini-month';
                mini.innerHTML = `<div class="mini-title">${m+1}</div>`;
                const daysBox = document.createElement('div');
                daysBox.className = 'mini-days';
                const lastD = new Date(yearlyYear, m+1, 0).getDate();
                for(let d=1; d<=lastD; d++) {
                    const dEl = document.createElement('div');
                    dEl.className = 'mini-day';
                    dEl.innerText = d;
                    if (yearlyDB[`${m}-${d}`]) dEl.classList.add('has-event');
                    dEl.onclick = () => {
                        const title = prompt(`${m+1}ì›” ${d}ì¼ ë°˜ë³µ ì¼ì • ì´ë¦„ (ì˜ˆ: ìƒì¼):`);
                        if(title) {
                            yearlyDB[`${m}-${d}`] = title;
                            localStorage.setItem('sb_yearly', JSON.stringify(yearlyDB));
                            renderYearlyView();
                        }
                    };
                    daysBox.appendChild(dEl);
                }
                mini.appendChild(daysBox);
                grid.appendChild(mini);
            }
        }

        // --- ìŠ¤í‹°ì»¤ ---
        const container = document.querySelector('.calendar-container');
        function spawnSticker(emoji) {
            const id = Date.now();
            const stickerObj = { id, emoji, x: 100, y: 100, year: currentDate.getFullYear(), month: currentDate.getMonth() };
            stickers.push(stickerObj);
            saveStickers();
            renderSticker(stickerObj);
        }
        function renderSticker(s) {
            const el = document.createElement('div');
            el.className = 'draggable-sticker';
            el.innerText = s.emoji;
            el.style.left = s.x + 'px'; el.style.top = s.y + 'px';
            el.style.position = 'absolute'; el.style.fontSize = '3rem'; el.style.cursor = 'grab'; el.style.zIndex = '500';
            el.id = `s-${s.id}`;
            el.onmousedown = function(e) {
                if(e.button === 2) return;
                e.preventDefault();
                let shiftX = e.clientX - el.getBoundingClientRect().left;
                let shiftY = e.clientY - el.getBoundingClientRect().top;
                function moveAt(pageX, pageY) {
                    const rect = container.getBoundingClientRect();
                    let newX = pageX - shiftX - rect.left;
                    let newY = pageY - shiftY - rect.top;
                    el.style.left = newX + 'px'; el.style.top = newY + 'px';
                }
                function onMouseMove(e) { moveAt(e.pageX, e.pageY); }
                document.addEventListener('mousemove', onMouseMove);
                el.onmouseup = function() {
                    document.removeEventListener('mousemove', onMouseMove);
                    el.onmouseup = null;
                    const idx = stickers.findIndex(x => x.id === s.id);
                    if(idx > -1) {
                        stickers[idx].x = parseFloat(el.style.left);
                        stickers[idx].y = parseFloat(el.style.top);
                        saveStickers();
                    }
                };
            };
            el.oncontextmenu = function(e) {
                e.preventDefault();
                if(confirm('ìŠ¤í‹°ì»¤ë¥¼ ë—„ê¹Œìš”?')) {
                    el.remove();
                    stickers = stickers.filter(x => x.id !== s.id);
                    saveStickers();
                }
            };
            container.appendChild(el);
        }
        function saveStickers() { localStorage.setItem('sb_stickers', JSON.stringify(stickers)); }
        function loadStickersToView() {
            document.querySelectorAll('.draggable-sticker').forEach(e => e.remove());
            const currentY = currentDate.getFullYear();
            const currentM = currentDate.getMonth();
            stickers.filter(s => s.year === currentY && s.month === currentM).forEach(s => renderSticker(s));
        }

        // --- ë‹¤ì´ì–´ë¦¬ ëª¨ë‹¬ ---
        const modal = document.getElementById('diary-modal');
        const diaryText = document.getElementById('diary-text');
        const scheduleInput = document.getElementById('daily-schedule-input');
        const scheduleList = document.getElementById('daily-schedule-list');
        const album = document.getElementById('photo-album');
        const iconSelect = document.getElementById('schedule-icon-select');

        function openDiary(y, m, d) {
            currentKey = `${y}-${m}-${d}`;
            const dateObj = new Date(y, m, d);
            const days = ['Sun','Mon','Tue','Wed','Thu','Fri','Sat'];
            document.getElementById('modal-date').innerText = `${y}.${m+1}.${d} (${days[dateObj.getDay()]})`;
            
            const data = diaryDB[currentKey] || { text: "", weather: "", mood: "", images: [], schedules: [] };
            diaryText.value = data.text;
            renderScheduleList(data.schedules);
            
            currentPhotoIndex = 0; 
            renderPhotoAlbum(data.images);
            
            document.querySelectorAll('input[name="weather"]').forEach(r => r.checked = (r.value === data.weather));
            document.querySelectorAll('input[name="mood"]').forEach(r => r.checked = (r.value === data.mood));

            modal.classList.add('active');
        }

        function closeDiary() { modal.classList.remove('active'); renderCalendar(); }

        function saveCurrentData() {
            if(!diaryDB[currentKey]) diaryDB[currentKey] = {};
            diaryDB[currentKey].text = diaryText.value;
            const w = document.querySelector('input[name="weather"]:checked');
            const m = document.querySelector('input[name="mood"]:checked');
            diaryDB[currentKey].weather = w ? w.value : "";
            diaryDB[currentKey].mood = m ? m.value : "";
            localStorage.setItem('sb_diary', JSON.stringify(diaryDB));
        }
        diaryText.addEventListener('input', saveCurrentData);
        document.querySelectorAll('input[type=radio]').forEach(r => r.addEventListener('change', saveCurrentData));

        // ìŠ¤ì¼€ì¤„ ì¶”ê°€ ë° ì œê±°
        function addDailySchedule() {
            const txt = scheduleInput.value.trim();
            const icon = iconSelect.value;
            if(!txt) return;
            if(!diaryDB[currentKey]) diaryDB[currentKey] = { schedules: [] };
            if(!diaryDB[currentKey].schedules) diaryDB[currentKey].schedules = [];
            
            diaryDB[currentKey].schedules.push({ icon: icon, text: txt });
            scheduleInput.value = '';
            saveCurrentData();
            renderScheduleList(diaryDB[currentKey].schedules);
        }

        function renderScheduleList(list) {
            scheduleList.innerHTML = '';
            if(!list) return;
            list.forEach((item, idx) => {
                const li = document.createElement('li');
                li.innerHTML = `<span>${item.icon} ${item.text}</span> <span style="cursor:pointer; color:var(--point-pink); font-size:1.1rem;" onclick="removeSchedule(${idx})">âŒ</span>`;
                scheduleList.appendChild(li);
            });
        }
        function removeSchedule(idx) {
            diaryDB[currentKey].schedules.splice(idx, 1);
            saveCurrentData();
            renderScheduleList(diaryDB[currentKey].schedules);
        }
        
        // ì‚¬ì§„ ìŠ¬ë¼ì´ë“œ ë¡œì§
        function slidePhoto(direction) {
            const images = (diaryDB[currentKey] && diaryDB[currentKey].images) || [];
            if (images.length <= 1) return;

            currentPhotoIndex += direction;

            if (currentPhotoIndex < 0) {
                currentPhotoIndex = images.length - 1; 
            } else if (currentPhotoIndex >= images.length) {
                currentPhotoIndex = 0; 
            }

            const offset = -currentPhotoIndex * 100; 
            album.style.transform = `translateX(${offset}%)`;
        }

        // ì‚¬ì§„ ì—…ë¡œë“œ (ë”¸ê¸°ì¼€ì´í¬ ë²„íŠ¼ìœ¼ë¡œë§Œ!)
        function uploadPhoto(event) {
            const file = event.target.files[0];
            document.getElementById('photo-input').value = ''; 

            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    if(!diaryDB[currentKey]) diaryDB[currentKey] = { images: [] };
                    if(!diaryDB[currentKey].images) diaryDB[currentKey].images = [];
                    diaryDB[currentKey].images.push(e.target.result);
                    localStorage.setItem('sb_diary', JSON.stringify(diaryDB));
                    
                    currentPhotoIndex = diaryDB[currentKey].images.length - 1; 
                    renderPhotoAlbum(diaryDB[currentKey].images);
                }
                reader.readAsDataURL(file);
            }
        }

        // ì‚¬ì§„ ì›ë³¸ ë³´ê¸° ë° ì‚­ì œ ë¡œì§
        function showLightbox(index) {
            currentLightboxIndex = index;
            const images = (diaryDB[currentKey] && diaryDB[currentKey].images) || [];
            if (images[index]) {
                document.getElementById('lightbox-img').src = images[index];
                document.getElementById('lightbox-modal').style.display = 'flex';
            }
        }

        function hideLightbox() {
            document.getElementById('lightbox-modal').style.display = 'none';
            currentLightboxIndex = -1;
        }

        function deleteLightboxPhoto() {
            if (currentLightboxIndex !== -1 && confirm("ì´ ì‚¬ì§„ì„ ì •ë§ ì‚­ì œí• ê¹Œìš”? ğŸ˜¢")) {
                diaryDB[currentKey].images.splice(currentLightboxIndex, 1);
                localStorage.setItem('sb_diary', JSON.stringify(diaryDB));
                
                currentPhotoIndex = Math.min(currentPhotoIndex, (diaryDB[currentKey].images || []).length - 1);
                if (currentPhotoIndex < 0) currentPhotoIndex = 0; 
                renderPhotoAlbum(diaryDB[currentKey].images);

                hideLightbox();
            }
        }
        
        // ì‚¬ì§„ ë¯¸ë‹ˆ ì‚­ì œ ë¡œì§
        function deletePhotoMini(idx) {
            if (confirm("ì´ ì‚¬ì§„ì„ ì •ë§ ì‚­ì œí• ê¹Œìš”? ğŸ˜¢")) {
                diaryDB[currentKey].images.splice(idx, 1);
                localStorage.setItem('sb_diary', JSON.stringify(diaryDB));
                
                // ì¸ë±ìŠ¤ ì¡°ì • ë° ì•¨ë²” ì¬ë Œë”ë§
                currentPhotoIndex = Math.min(currentPhotoIndex, (diaryDB[currentKey].images || []).length - 1);
                if (currentPhotoIndex < 0) currentPhotoIndex = 0; 
                renderPhotoAlbum(diaryDB[currentKey].images);
            }
        }

        function renderPhotoAlbum(images) {
            album.innerHTML = '';
            
            const prevBtn = document.querySelector('.prev-btn');
            const nextBtn = document.querySelector('.next-btn');

            if (images && images.length > 1) {
                prevBtn.style.display = 'block';
                nextBtn.style.display = 'block';
            } else {
                prevBtn.style.display = 'none';
                nextBtn.style.display = 'none';
            }

            if(!images || images.length === 0) {
                album.style.transform = `translateX(0)`; 
                return;
            }

            // ì•¨ë²” ë Œë”ë§
            images.forEach((imgSrc, idx) => {
                const frame = document.createElement('div');
                frame.className = 'photo-frame';
                frame.innerHTML = `<img src="${imgSrc}">`;

                // ë¯¸ë‹ˆ ì‚­ì œ ë²„íŠ¼ ìƒì„± ë° ì¶”ê°€
                const deleteBtn = document.createElement('div');
                deleteBtn.className = 'delete-photo-mini';
                deleteBtn.innerHTML = 'âŒ'; 
                deleteBtn.onclick = (e) => {
                    e.stopPropagation(); 
                    deletePhotoMini(idx);
                };
                frame.appendChild(deleteBtn);
                
                // í´ë¦­ ì‹œ ë¼ì´íŠ¸ë°•ìŠ¤ ë„ìš°ê¸° (ì›ë³¸ ë³´ê¸°)
                frame.onclick = (e) => {
                    e.stopPropagation(); 
                    showLightbox(idx);
                };
                album.appendChild(frame);
            });

            // í˜„ì¬ ì¸ë±ìŠ¤ë¡œ ì´ë™
            const offset = -currentPhotoIndex * 100;
            album.style.transform = `translateX(${offset}%)`; 
        }
        
        // ì í”„ ë° ì˜¤ëŠ˜ë¡œ ëŒì•„ê°€ê¸°
        function initPicker() {
            const ys = document.getElementById('year-select');
            const ms = document.getElementById('month-select');
            const cy = new Date().getFullYear();
            for(let i=cy-5; i<=cy+5; i++) {
                ys.innerHTML += `<option value="${i}" ${i===cy?'selected':''}>${i}</option>`;
            }
            for(let i=0; i<12; i++) {
                ms.innerHTML += `<option value="${i}">${i+1}ì›”</option>`;
            }
        }
        function togglePicker() { document.getElementById('date-picker').classList.toggle('show'); }
        function jumpToDate() {
            const y = document.getElementById('year-select').value;
            const m = document.getElementById('month-select').value;
            currentDate = new Date(y, m, 1);
            renderCalendar();
            togglePicker();
        }
        function goToToday() {
            currentDate = new Date(); 
            renderCalendar(); 
            document.getElementById('yearly-page').classList.remove('active');
        }

        initPicker();
        renderCalendar();
    </script>
</body>
</html>